[
  {
    "objectID": "doe.html",
    "href": "doe.html",
    "title": "Design of Experiments",
    "section": "",
    "text": "The main motivation driving the need for DOE is to get the most out of the smallest number of experiments. Experiments are expensive, long, and prone to error. With DOE, we can understand and improve our process with much less work, thanks to some clever experimental planning. Our main goal is to:\n\nUnderstanding Cause and Effect: Intelligently changing factors (nutrient levels, pH, etc.) and observing the results reveals true cause-and-effect relationships, which is crucial for optimising your process.\n\nImagine your goal is to maximise the yield of a desired product. You suspect factors like temperature, reaction time, and agitation speed might be important. Our overall methodology will look like this:\n\nScreening: Structured initial experiments give you a starting point, showing which factors truly influence yield.\nOptimisation: You adjust the important factors, saving resources by excluding less impactful ones (e.g., using no feed if the feed has proven ineffective).\nImprovement: Iterative experiments can fine-tune the process, leading to the most profitable conditions.\n\n\n\n\nBefore we go on, it is necessary to agree on some definitions:\n\nOutcome (or Response): A measurable result from an experiment. Examples include antibody yield, cell density, or product purity.\nFactors (or Variables): Elements of the experiment that you intentionally change to influence the outcome. Examples include nutrient levels, temperature, pH, and agitation speed.\n\nTypes of Factors\n\nContinuous (or Quantitative) Factors: Measured on a numerical scale with a meaningful order (e.g., temperature in degrees Celsius, agitation speed in RPM). Sometimes called numeric.\nCategorical (or Qualitative) Factors: Represent distinct categories without inherent order (e.g., different media types, different impellers).\n\nExperimental units\nEach individual experimental setup with a specific combination of factors is called a run or treatment. A treatment set will involve multiple runs to explore the effects of different factors on the outcome.\n\n\n\nMaybe you are used to changing one variable (temperature, nutrient level, etc.) at a time, holding others constant, and then picking the best result before moving to the next factor. This is called the One Factor At a Time approach (or OFAT). While intuitive, this method has significant drawbacks that have been understood since at least the early 1930s, thanks to the work of R. A. Fisher (1926).\nI think this is best illustrated with an example.\nExample: Optimizing Enzyme Yield\nConsider a bioreactor where we produce a particular enzyme, with yield affected by factors like temperature and feed substrate concentration.\n\nStarting Point: We begin our experiment at a temperature of 346 K (Base case) and a substrate concentration of 1.5 g/L, obtaining a yield of 63%.\nChanging Temperature: We increase the temperature and see a decrease in yield, so we go the other way and lower the temperature. This increases the yield until it plateaus. We’ve improved the yield to 67%.\nChanging Substrate Concentration: We then adjust the substrate concentration, first up and then down, until we find another plateau. We end up at 330 K and 0.75 g/L, improving the yield to 69.5% (Final).\n\nLimitations:\n\nWe have missed the true optimum. The combination that gives the highest yield was never tested.\nWe might have arrived at a completely different result had we changed the substrate concentration first. Our system gives different results according to the order of experiments, which is not good.\nWe do not know how other factors (DO level, agitation rate, substrate type) influence our process.\n\n\n\n\nLet’s consider an alternative approach to such a two-dimensional problem (two dimensions meaning that the parameter space can be shown with a 2D graph, as seen above). Let me introduce factorial designs. Unlike the (OFAT) approach, factorial designs enable us to investigate how multiple factors interact, which is crucial for process optimisation.\nExample: Optimizing a Bioreactor\nConsider a bioreactor where we want to maximise a reaction’s conversion. Let’s examine how temperature (°K) and substrate concentration (g/L) affect this conversion. In this example, we will start with a \\(2^2\\)-factorial design (factorial designs are indicated with \\(n^k\\), where \\(k\\) is the number of variables in the design and \\(n\\) the number of levels for each factor).\nWe will choose intentionally low (-) and high (+) levels of each factor, and produce the experimental design indicated below. After running the 4 experiments, we will note down the conversion rates in the appropriate column. We will always run the experiment in random order, but for the sake of clarity, we show them here in standard order.\n\n\n\n\n\n\n\n\n\nExperiment\nTemperature [K]\nSubstrate [g/L]\nConversion (%)\n\n\n\n\n1\n-\n-\n69\n\n\n2\n+\n-\n60\n\n\n3\n-\n+\n64\n\n\n4\n+\n+\n53\n\n\n\nMain Effects: How Factors Influence the Outcome\nHow much change do we observe for each factor when that factor is changed from its low (-) to high (+) level? Here’s how we would intuitively calculate it:\n\nFind pairs of experiments in which only the factor of interest changes. For example, to calculate the effect of temperature, we compare experiments 1 and 2 (where temperature changes, but substrate remains constant) and experiments 3 and 4 (same change).\nFor each pair, subtract the outcome at the low level from the outcome at the high level. This gives the change caused by the factor. Since we have two pairs (1 and 2, 3 and 4), we average the differences, which gives the overall main effect of that factor.\n\nIf we do this calculation, we see the following result:\n\nTemperature Effect: (experiments 1 & 2 and experiments 3 & 4) We can see that, on average, we have a -10% conversion decrease for a +16 K temperature change.\nSubstrate Effect: (experiments 1 & 3 and experiments 2 & 4) yield an average effect of -6% conversion change per 0.5 g/L substrate change.\n\nIn this specific case, the differences were quite similar to each other within the pair, and averaging them did not make a big difference:\n\n\\(\\Delta T_{S(-)}= 60 - 69 = -9\\%\\), and \\(\\Delta T_{S(+)}= 53 - 64 = -11\\%\\) average to a \\(-10\\%\\) change from low to high temperature.\n\\(\\Delta S_{T(-)}= 53 - 60 = -7\\%\\), and \\(\\Delta S_{T(-)}= 64- 69 = -5\\%\\) average to a \\(-9\\%\\) change from low to high substrate concentration.\n\nIf we visualise them on a 3D plot, we notice how the surface more or less resembles a plane (slightly warped because of the small differences within each pair), where each factor contributes more or less the same amount regardless of what happens with the other factor. But what if this was not the case?\n\nInteractions: When Factors Work Together (or Against Each Other)\nIn many real-world systems, the effect of one factor depends on the level of another. This is called an interaction. For our bioreactor example, the temperature effect on conversion might be much greater at high substrate concentrations. Let’s consider the example in which we would have gotten the following result instead:\n\nIn this case, the differences are very different within the pair:\n\n\n\n\n\n\n\n\nExperiment\nTemperature [K]\nSubstrate [g/L]\nConversion (%)\n\n\n\n\n1\n-\n-\n77\n\n\n2\n+\n-\n79\n\n\n3\n-\n+\n81\n\n\n4\n+\n+\n89\n\n\n\n\n\\(\\Delta T_{S(-)}= 79 - 77 = 2\\%\\), and \\(\\Delta T_{S(+)}= 89 - 81 = 8\\%\\) average to a \\(5\\%\\) change from low to high temperature.\n\\(\\Delta S_{T(-)}= 81 - 77 = 4\\%\\), and \\(\\Delta S_{T(-)}= 89 - 79 = 10\\%\\) average to a \\(7\\%\\) change from low to high substrate concentration.\n\nThe temperature effect is much stronger at high substrate concentrations than at the low level (\\(8\\%\\) vs. \\(2\\%\\)). Calculating the main effects alone hides this interaction. A contour plot shows that a plane can no longer approximate the surface, and it looks much more warped and irregular.\n\nHow can we record and express what we have seen so far? In the next section, we will introduce a way to mathematically interpret main effects and interactions using a simple linear least squares model."
  },
  {
    "objectID": "doe.html#motivation",
    "href": "doe.html#motivation",
    "title": "Design of Experiments",
    "section": "",
    "text": "The main motivation driving the need for DOE is to get the most out of the smallest number of experiments. Experiments are expensive, long, and prone to error. With DOE, we can understand and improve our process with much less work, thanks to some clever experimental planning. Our main goal is to:\n\nUnderstanding Cause and Effect: Intelligently changing factors (nutrient levels, pH, etc.) and observing the results reveals true cause-and-effect relationships, which is crucial for optimising your process.\n\nImagine your goal is to maximise the yield of a desired product. You suspect factors like temperature, reaction time, and agitation speed might be important. Our overall methodology will look like this:\n\nScreening: Structured initial experiments give you a starting point, showing which factors truly influence yield.\nOptimisation: You adjust the important factors, saving resources by excluding less impactful ones (e.g., using no feed if the feed has proven ineffective).\nImprovement: Iterative experiments can fine-tune the process, leading to the most profitable conditions."
  },
  {
    "objectID": "doe.html#terminology",
    "href": "doe.html#terminology",
    "title": "Design of Experiments",
    "section": "",
    "text": "Before we go on, it is necessary to agree on some definitions:\n\nOutcome (or Response): A measurable result from an experiment. Examples include antibody yield, cell density, or product purity.\nFactors (or Variables): Elements of the experiment that you intentionally change to influence the outcome. Examples include nutrient levels, temperature, pH, and agitation speed.\n\nTypes of Factors\n\nContinuous (or Quantitative) Factors: Measured on a numerical scale with a meaningful order (e.g., temperature in degrees Celsius, agitation speed in RPM). Sometimes called numeric.\nCategorical (or Qualitative) Factors: Represent distinct categories without inherent order (e.g., different media types, different impellers).\n\nExperimental units\nEach individual experimental setup with a specific combination of factors is called a run or treatment. A treatment set will involve multiple runs to explore the effects of different factors on the outcome."
  },
  {
    "objectID": "doe.html#how-not-to-do-it",
    "href": "doe.html#how-not-to-do-it",
    "title": "Design of Experiments",
    "section": "",
    "text": "Maybe you are used to changing one variable (temperature, nutrient level, etc.) at a time, holding others constant, and then picking the best result before moving to the next factor. This is called the One Factor At a Time approach (or OFAT). While intuitive, this method has significant drawbacks that have been understood since at least the early 1930s, thanks to the work of R. A. Fisher (1926).\nI think this is best illustrated with an example.\nExample: Optimizing Enzyme Yield\nConsider a bioreactor where we produce a particular enzyme, with yield affected by factors like temperature and feed substrate concentration.\n\nStarting Point: We begin our experiment at a temperature of 346 K (Base case) and a substrate concentration of 1.5 g/L, obtaining a yield of 63%.\nChanging Temperature: We increase the temperature and see a decrease in yield, so we go the other way and lower the temperature. This increases the yield until it plateaus. We’ve improved the yield to 67%.\nChanging Substrate Concentration: We then adjust the substrate concentration, first up and then down, until we find another plateau. We end up at 330 K and 0.75 g/L, improving the yield to 69.5% (Final).\n\nLimitations:\n\nWe have missed the true optimum. The combination that gives the highest yield was never tested.\nWe might have arrived at a completely different result had we changed the substrate concentration first. Our system gives different results according to the order of experiments, which is not good.\nWe do not know how other factors (DO level, agitation rate, substrate type) influence our process."
  },
  {
    "objectID": "doe.html#factorial-designs",
    "href": "doe.html#factorial-designs",
    "title": "Design of Experiments",
    "section": "",
    "text": "Let’s consider an alternative approach to such a two-dimensional problem (two dimensions meaning that the parameter space can be shown with a 2D graph, as seen above). Let me introduce factorial designs. Unlike the (OFAT) approach, factorial designs enable us to investigate how multiple factors interact, which is crucial for process optimisation.\nExample: Optimizing a Bioreactor\nConsider a bioreactor where we want to maximise a reaction’s conversion. Let’s examine how temperature (°K) and substrate concentration (g/L) affect this conversion. In this example, we will start with a \\(2^2\\)-factorial design (factorial designs are indicated with \\(n^k\\), where \\(k\\) is the number of variables in the design and \\(n\\) the number of levels for each factor).\nWe will choose intentionally low (-) and high (+) levels of each factor, and produce the experimental design indicated below. After running the 4 experiments, we will note down the conversion rates in the appropriate column. We will always run the experiment in random order, but for the sake of clarity, we show them here in standard order.\n\n\n\n\n\n\n\n\n\nExperiment\nTemperature [K]\nSubstrate [g/L]\nConversion (%)\n\n\n\n\n1\n-\n-\n69\n\n\n2\n+\n-\n60\n\n\n3\n-\n+\n64\n\n\n4\n+\n+\n53\n\n\n\nMain Effects: How Factors Influence the Outcome\nHow much change do we observe for each factor when that factor is changed from its low (-) to high (+) level? Here’s how we would intuitively calculate it:\n\nFind pairs of experiments in which only the factor of interest changes. For example, to calculate the effect of temperature, we compare experiments 1 and 2 (where temperature changes, but substrate remains constant) and experiments 3 and 4 (same change).\nFor each pair, subtract the outcome at the low level from the outcome at the high level. This gives the change caused by the factor. Since we have two pairs (1 and 2, 3 and 4), we average the differences, which gives the overall main effect of that factor.\n\nIf we do this calculation, we see the following result:\n\nTemperature Effect: (experiments 1 & 2 and experiments 3 & 4) We can see that, on average, we have a -10% conversion decrease for a +16 K temperature change.\nSubstrate Effect: (experiments 1 & 3 and experiments 2 & 4) yield an average effect of -6% conversion change per 0.5 g/L substrate change.\n\nIn this specific case, the differences were quite similar to each other within the pair, and averaging them did not make a big difference:\n\n\\(\\Delta T_{S(-)}= 60 - 69 = -9\\%\\), and \\(\\Delta T_{S(+)}= 53 - 64 = -11\\%\\) average to a \\(-10\\%\\) change from low to high temperature.\n\\(\\Delta S_{T(-)}= 53 - 60 = -7\\%\\), and \\(\\Delta S_{T(-)}= 64- 69 = -5\\%\\) average to a \\(-9\\%\\) change from low to high substrate concentration.\n\nIf we visualise them on a 3D plot, we notice how the surface more or less resembles a plane (slightly warped because of the small differences within each pair), where each factor contributes more or less the same amount regardless of what happens with the other factor. But what if this was not the case?\n\nInteractions: When Factors Work Together (or Against Each Other)\nIn many real-world systems, the effect of one factor depends on the level of another. This is called an interaction. For our bioreactor example, the temperature effect on conversion might be much greater at high substrate concentrations. Let’s consider the example in which we would have gotten the following result instead:\n\nIn this case, the differences are very different within the pair:\n\n\n\n\n\n\n\n\nExperiment\nTemperature [K]\nSubstrate [g/L]\nConversion (%)\n\n\n\n\n1\n-\n-\n77\n\n\n2\n+\n-\n79\n\n\n3\n-\n+\n81\n\n\n4\n+\n+\n89\n\n\n\n\n\\(\\Delta T_{S(-)}= 79 - 77 = 2\\%\\), and \\(\\Delta T_{S(+)}= 89 - 81 = 8\\%\\) average to a \\(5\\%\\) change from low to high temperature.\n\\(\\Delta S_{T(-)}= 81 - 77 = 4\\%\\), and \\(\\Delta S_{T(-)}= 89 - 79 = 10\\%\\) average to a \\(7\\%\\) change from low to high substrate concentration.\n\nThe temperature effect is much stronger at high substrate concentrations than at the low level (\\(8\\%\\) vs. \\(2\\%\\)). Calculating the main effects alone hides this interaction. A contour plot shows that a plane can no longer approximate the surface, and it looks much more warped and irregular.\n\nHow can we record and express what we have seen so far? In the next section, we will introduce a way to mathematically interpret main effects and interactions using a simple linear least squares model."
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "References"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Index",
    "section": "",
    "text": "Index\nThis book is intended as a theory refresh for people looking into the design of experiments"
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Summary",
    "section": "",
    "text": "Summary\nIn summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Introduction\nThis is a book created from markdown and executable code.\nSee (knuth84?) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "stat_concepts.html",
    "href": "stat_concepts.html",
    "title": "Review of statistical concepts",
    "section": "",
    "text": "Before we start, we must briefly review basic statistical inference concepts such as variation, parameter estimation, and hypotheses testing. To avoid overly complex math, we will assume that our data is normally distributed (more on that later).\n\n\n\n\nEven in a bioreactor’s highly controlled environment, natural fluctuations between batches will occur. Sources of this variation include inherent differences within biological systems and subtle inconsistencies during measurement.\nA Random Variable is a mathematical object representing the possible outcomes of a process that has some degree of inherent randomness—for example, the possible outputs of an antibody yield measurement for different batches.\nWe formally describe the observation for the \\(i\\)th batch measurement by the outcome \\(y_i\\) of its associated random variable \\(Y_i\\) (representing all possible yield batch measurements within a given production process).\nProbability distributions are useful functions that map random variables to the probability of certain outcomes.\n\nThe Probability Density Function (PDF), \\(f_Y(y)\\), is a useful tool to find the probability of a certain outcome (e.g. yield) falling within a range. The area under the PDF between the values \\(a\\) and \\(b\\) gives the probability that a realization of \\(Y\\) falls into the interval \\([a,b]\\) and is formalized as\\[\\mathbb{P}(Y\\in [a,b]) = \\mathbb{P}(a\\leq Y\\leq b) = \\int_a^b f_Y(y) dy = F_Y(b)-F_Y(a)\\]\nThe Cumulative Distribution Functions (CDF), \\(F_Y(y)\\) is a related function (actually the integral of the PDF) where the output represents the probability that a yield will be less than or equal to a specific value \\(y\\): \\[F_Y(y) = \\mathbb{P}(Y\\leq y) = \\int_{-\\infty}^y f_Y(y) dy\\]\n\nExample: Exploring Antibody Yield Data\nSuppose we collect antibody yield data from 10 bioreactor runs. Each run’s yield is represented by the outcome \\(y_i\\) of its associated random variable \\(Y_i\\).\n\n# Generate sample bioreactor yield data\ndf &lt;- data.frame(Yield = round(rnorm(10, mean = 30, sd = 3), digits = 2))\ndf\n\n   Yield\n1  37.10\n2  27.39\n3  32.00\n4  28.82\n5  30.48\n6  31.73\n7  25.40\n8  29.42\n9  33.34\n10 33.16\n\n\nIt is often reasonable to assume that such a measurement is normally distributed, meaning that its underlying PDF is a normal (or Gaussian) curve. This distribution takes two parameters specific to the sample: the mean (\\(\\mu\\)), which is the distribution’s centre, and the Variance \\(\\sigma^2\\), which represents how spread out the distribution is.\n\\[ f_Y(y;\\mu,\\sigma^2) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\cdot\\exp\\left(-\\frac{1}{2}\\cdot\\left(\\frac{y-\\mu}{\\sigma}\\right)^2\\right)\\]\nBy plugging in the specific mean and standard deviation for our sample (\\(\\mu = 30\\), \\(\\sigma^2 = 3\\)) the function creates a bell-shaped curve that we can use to calculate probabilities of specific yield outcomes.\nKey Takeaways\n\nVariability in bioreactor yields is natural and expected.\nRandom variables and probability distributions help us model and quantify this variation.\nThe normal distribution is a common and useful assumption for this type of data."
  },
  {
    "objectID": "stat_concepts.html#probability",
    "href": "stat_concepts.html#probability",
    "title": "Review of statistical concepts",
    "section": "",
    "text": "Even in a bioreactor’s highly controlled environment, natural fluctuations between batches will occur. Sources of this variation include inherent differences within biological systems and subtle inconsistencies during measurement.\nA Random Variable is a mathematical object representing the possible outcomes of a process that has some degree of inherent randomness—for example, the possible outputs of an antibody yield measurement for different batches.\nWe formally describe the observation for the \\(i\\)th batch measurement by the outcome \\(y_i\\) of its associated random variable \\(Y_i\\) (representing all possible yield batch measurements within a given production process).\nProbability distributions are useful functions that map random variables to the probability of certain outcomes.\n\nThe Probability Density Function (PDF), \\(f_Y(y)\\), is a useful tool to find the probability of a certain outcome (e.g. yield) falling within a range. The area under the PDF between the values \\(a\\) and \\(b\\) gives the probability that a realization of \\(Y\\) falls into the interval \\([a,b]\\) and is formalized as\\[\\mathbb{P}(Y\\in [a,b]) = \\mathbb{P}(a\\leq Y\\leq b) = \\int_a^b f_Y(y) dy = F_Y(b)-F_Y(a)\\]\nThe Cumulative Distribution Functions (CDF), \\(F_Y(y)\\) is a related function (actually the integral of the PDF) where the output represents the probability that a yield will be less than or equal to a specific value \\(y\\): \\[F_Y(y) = \\mathbb{P}(Y\\leq y) = \\int_{-\\infty}^y f_Y(y) dy\\]\n\nExample: Exploring Antibody Yield Data\nSuppose we collect antibody yield data from 10 bioreactor runs. Each run’s yield is represented by the outcome \\(y_i\\) of its associated random variable \\(Y_i\\).\n\n# Generate sample bioreactor yield data\ndf &lt;- data.frame(Yield = round(rnorm(10, mean = 30, sd = 3), digits = 2))\ndf\n\n   Yield\n1  37.10\n2  27.39\n3  32.00\n4  28.82\n5  30.48\n6  31.73\n7  25.40\n8  29.42\n9  33.34\n10 33.16\n\n\nIt is often reasonable to assume that such a measurement is normally distributed, meaning that its underlying PDF is a normal (or Gaussian) curve. This distribution takes two parameters specific to the sample: the mean (\\(\\mu\\)), which is the distribution’s centre, and the Variance \\(\\sigma^2\\), which represents how spread out the distribution is.\n\\[ f_Y(y;\\mu,\\sigma^2) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\cdot\\exp\\left(-\\frac{1}{2}\\cdot\\left(\\frac{y-\\mu}{\\sigma}\\right)^2\\right)\\]\nBy plugging in the specific mean and standard deviation for our sample (\\(\\mu = 30\\), \\(\\sigma^2 = 3\\)) the function creates a bell-shaped curve that we can use to calculate probabilities of specific yield outcomes.\nKey Takeaways\n\nVariability in bioreactor yields is natural and expected.\nRandom variables and probability distributions help us model and quantify this variation.\nThe normal distribution is a common and useful assumption for this type of data."
  }
]